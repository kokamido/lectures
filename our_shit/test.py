import torch

a = torch.tensor(
    [
        [0.45042956, 0.87967783, 0.10394317, 0.0],
        [
            0.7393817,
            0.9769644,
            0.10645878,
            0,
        ],
        [
            0.14989454,
            0.8805295,
            0.55228853,
            0,
        ],
        [
            0,
            0,
            0,
            0,
        ],
    ]
)

b = torch.tensor(
    [
        [
            0.08607091,
            0.11875958,
            -0.26606384,
            0,
        ],
        [
            -0.1387098,
            0.15001155,
            -0.02446777,
            0,
        ],
        [
            -0.18929473,
            -0.2771447,
            0.12702614,
            0,
        ],
        [
            0,
            0,
            0,
            0,
        ],
    ]
)
res = a * b
print(res.sum(), res.mean())
import torch.nn.functional as F

s = F.conv2d(a.reshape((1, 1, 4, 4)), b.reshape((1, 1, 4, 4)))
print(s)
print(F.conv2d(a[0:3, 0:3].reshape((1, 1, 3, 3)), b[0:3, 0:3].reshape((1, 1, 3, 3))))
